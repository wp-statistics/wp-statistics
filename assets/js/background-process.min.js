jQuery(document).ready(function(t){var i={migrationNotice:null,init:function(){this.migrationNotice=jQuery("#wp-statistics-background-process-notice"),this.bindEvents(),"progress"===Wp_Statistics_Background_Process_Data.status&&this.startMigration()},bindEvents:function(){this.migrationNotice.length&&this.migrationNotice.find("#start-migration-btn").on("click",this.handleStartMigration)},handleStartMigration:function(t){t.preventDefault(),window.location.href=jQuery(this).attr("href")},startMigration:function(){jQuery.ajax({url:Wp_Statistics_Background_Process_Data.ajax_url,method:"POST",data:{action:"wp_statistics_background_process",wps_nonce:Wp_Statistics_Background_Process_Data.rest_api_nonce},success:function(t){t.success&&(t.data.completed?i.markAsCompleted():(i.updateProgress(t.data.remains),i.startMigration()))},error:function(t,i,n){console.error("AJAX request error:",i,n)}})},updateProgress:function(t){this.migrationNotice.length&&this.migrationNotice.find(".remain-number").text(t)},markAsCompleted:function(){this.migrationNotice.length&&this.migrationNotice.html("<p><strong>WP Statistics: Migration Complete</strong></p><p>All records have been successfully migrated. WP Statistics is now up-to-date.</p>")}};jQuery(document).ready(function(){i.init()})});