jQuery(document).ready(function(t){var e={migrationNotice:null,init:function(){this.migrationNotice=jQuery("#wp-statistics-background-process-notice"),this.bindEvents(),"progress"===Wp_Statistics_Background_Process_Data.status&&this.startMigration()},bindEvents:function(){this.migrationNotice.length&&this.migrationNotice.find("#start-migration-btn").on("click",this.handleStartMigration)},handleStartMigration:function(t){t.preventDefault(),window.location.href=jQuery(this).attr("href")},startMigration:function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;jQuery.ajax({url:Wp_Statistics_Background_Process_Data.ajax_url,method:"POST",data:{action:"wp_statistics_background_process",wps_nonce:Wp_Statistics_Background_Process_Data.rest_api_nonce,total:i},success:function(t){t.success&&(t.data.completed?e.markAsCompleted():(e.updateProgress(t.data.percentage),i=parseInt(null==(t=t.data)?void 0:t.total,10)||0,e.startMigration(i)))},error:function(t,i,e){console.error("AJAX request error:",i,e)}})},updateProgress:function(t){this.migrationNotice.length&&this.migrationNotice.find(".remain-percentage").text(t)},markAsCompleted:function(){this.migrationNotice.length&&(this.migrationNotice.closest(".notice").removeClass("notice-info").addClass("notice-success"),this.migrationNotice.html("<p><strong>WP Statistics: Migration Complete</strong></p><p>All records have been successfully migrated. WP Statistics is now up-to-date.</p>"))}};jQuery(document).ready(function(){e.init()})});