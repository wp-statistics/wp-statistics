# WP Statistics Dummy Data Generators

Generate test data for WP Statistics v15 by simulating HTTP requests or direct database inserts.

## Quick Start

```bash
cd wp-content/plugins/wp-statistics

# Simple: Generate 7 days of realistic traffic via HTTP
php bin/dummy-tracker-simulator.php --days=7 --visitors-per-day=50

# Fast: Insert 100K records directly into database
php bin/direct-data-generator.php --target=100K

# Clear all data before regenerating
php bin/clear-dummy-data.php --force
```

## Four Commands

| Command | Use Case |
|---------|----------|
| `dummy-tracker-simulator.php` | Realistic traffic via HTTP (recommended for testing) |
| `direct-data-generator.php` | Fast bulk insert for large datasets |
| `stress-test-simulator.php` | Stress testing, security validation, edge cases |
| `clear-dummy-data.php` | Clean / Reset database before regenerating |

---

## Tracker Simulator vs Direct Data Generator

When generating test data, there are two main approaches. Choose based on your needs:

| Aspect | Tracker Simulator | Direct Data Generator |
|--------|------------------|---------------------|
| **Realism** | Full pipeline (validation, signature, MaxMind geo) | Bypasses all validation |
| **Geo-IP** | Uses MaxMind lookup from real IP | Hardcodes city, may mismatch |
| **Data Quality** | Matches production exactly | May have inconsistencies |
| **Hash** | Generated by real `Ip::hash()` (40 chars) | Manual hash, may differ |
| **Hooks/Filters** | All fire correctly | Bypassed |
| **Speed** | Slower (HTTP requests) | Much faster (direct DB) |
| **Requirement** | Web server must be running | Works without server |
| **Best For** | Testing, development, demos | Large datasets, benchmarks |

**Recommendation**:
- Use `dummy-tracker-simulator.php` for realistic testing that exercises the full tracking pipeline
- Use `direct-data-generator.php` when you need to quickly insert huge amounts of data

---

## Resource Types Generated

The Tracker Simulator generates traffic for all page types with realistic distribution:

| Type | Distribution | Example URL |
|------|--------------|-------------|
| Posts/Pages | 55% | `/hello-world/`, `/about/` |
| Homepage | 15% | `/` |
| Categories | 10% | `/category/uncategorized/` |
| Authors | 5% | `/author/admin/` |
| Tags | 5% | `/tag/wordpress/` |
| Search | 5% | `/?s=wordpress+tutorial` |
| 404 Errors | 5% | `/non-existent-page/` |

This ensures all dashboard pages have data:
- Entry Pages (first page of each session)
- Exit Pages (last page of each session)
- Category Pages (`/category/*`)
- Author Pages (`/author/*`)
- Tag Pages (`/tag/*`)
- 404 Pages (broken URLs)
- Search Pages (search results)

---

## Clean / Reset Database

Clear all WP Statistics data before generating fresh data.

```bash
# Interactive mode (asks for confirmation)
php bin/clear-dummy-data.php

# Force mode (no confirmation)
php bin/clear-dummy-data.php --force
```

This truncates all statistics tables for a clean start:
- visitors, sessions, views
- resources, resource_uris
- countries, cities
- referrers
- device_types, device_browsers, device_browser_versions, device_os
- resolutions, languages, timezones
- summary, summary_totals

---

## Dummy Tracker Simulator

Generates realistic traffic by sending HTTP requests to admin-ajax.php, exercising the full tracking pipeline.

### Prerequisites

Before running, ensure these settings are enabled:
- **Client-side tracking** (`use_cache_plugin`)
- **Bypass ad blockers** (`bypass_ad_blockers`)

**Note:** Signature validation is automatically disabled during simulation via a temporary mu-plugin that is created at start and removed on completion.

### Options

| Option | Description | Default |
|--------|-------------|---------|
| `--days=N` | Days to generate | 7 |
| `--from=DATE` | Start date (YYYY-MM-DD) | calculated |
| `--to=DATE` | End date | today |
| `--visitors-per-day=N` | Visitors per day | 50 |
| `--delay=MS` | Delay between requests | 50 |
| `--url=URL` | Custom site URL | auto |
| `--verbose` | Detailed output | false |
| `--dry-run` | No HTTP requests | false |

### Examples

```bash
# Week of data
php bin/dummy-tracker-simulator.php --days=7 --visitors-per-day=50

# Month of data
php bin/dummy-tracker-simulator.php --days=30 --visitors-per-day=100

# Custom date range
php bin/dummy-tracker-simulator.php --from=2024-01-01 --to=2024-03-31

# Test without requests
php bin/dummy-tracker-simulator.php --days=1 --dry-run --verbose
```

---

## Direct Data Generator

Inserts data directly into the database, bypassing the HTTP tracking pipeline. **Best for quickly generating huge datasets** when you don't need perfect production-accuracy.

### When to Use

- Generating 100K+ records quickly
- Benchmarking dashboard performance
- Testing pagination and filtering with large datasets
- When web server is not running

### Options

| Option | Description | Default |
|--------|-------------|---------|
| `--target=N` | Records to generate (supports K/M: 100K, 1M) | 1000 |
| `--days=N` | Date range to spread data across | 30 |
| `--logged-in-ratio=N` | Ratio of logged-in visitors | 0.12 |
| `--verbose` | Detailed output | false |

### Examples

```bash
# Generate 10,000 records
php bin/direct-data-generator.php --target=10K

# Generate 100,000 records across 90 days
php bin/direct-data-generator.php --target=100K --days=90

# Generate 1 million records for stress testing
php bin/direct-data-generator.php --target=1M --days=365
```

### Limitations

- Geo data may not match IP addresses (uses hardcoded cities)
- Visitor hashes may differ from production format
- Hooks and filters are not triggered
- Some data relationships may be simplified

---

## Stress Test Simulator

Advanced testing with parallel requests, invalid data, and attack payloads.

### Options

| Option | Description | Default |
|--------|-------------|---------|
| `--target=N` | Records to generate (supports K/M: 100K, 1M) | 1000 |
| `--workers=N` | Parallel HTTP workers | 10 |
| `--scenario=NAME` | Preset: normal, stress, invalid, security, mixed | normal |
| `--invalid-ratio=N` | Invalid data ratio (0.0-1.0) | 0.0 |
| `--attack-ratio=N` | Attack payload ratio (0.0-1.0) | 0.0 |
| `--logged-in-ratio=N` | Logged-in visitor ratio | 0.12 |
| `--days=N` | Date range | 30 |
| `--resume` | Resume from checkpoint | false |
| `--checkpoint-id=ID` | Checkpoint name | auto |

### Scenarios

| Scenario | Invalid | Attack | Description |
|----------|---------|--------|-------------|
| `normal` | 0% | 0% | Realistic traffic |
| `stress` | 0% | 0% | High-volume (100K+) |
| `invalid` | 50% | 0% | Edge cases, malformed data |
| `security` | 0% | 20% | Attack payload testing |
| `mixed` | 10% | 5% | All data types |

### Examples

```bash
# Stress test
php bin/stress-test-simulator.php --target=100K --scenario=stress --workers=20

# Security testing
php bin/stress-test-simulator.php --target=5000 --scenario=security

# Custom ratios
php bin/stress-test-simulator.php --target=10K --invalid-ratio=0.1 --attack-ratio=0.05

# Resume interrupted job
php bin/stress-test-simulator.php --resume --checkpoint-id=my-test
```

---

## Data Patterns

### Traffic Distribution

- **Devices**: Desktop 60%, Mobile 35%, Tablet 5%
- **Browsers**: Chrome 65%, Firefox 15%, Safari 12%, Edge 6%
- **Countries**: US 35%, UK 10%, CA 8%, DE 6%, others distributed
- **Referrers**: Direct 40%, Search 30%, Social 15%, Referral 10%

### Weekday Multipliers

Mon 1.0x, Tue 1.1x, Wed 1.2x (peak), Thu 1.1x, Fri 0.9x, Sat 0.6x, Sun 0.5x

---

## Requirements

- WordPress with WP Statistics active
- PHP CLI access
- Web server running (for HTTP-based simulators)

Settings auto-configured:
- `bypass_ad_blockers` = enabled
- `use_cache_plugin` = enabled

---

## Troubleshooting

**"Cannot connect to site"**
- Ensure web server is running
- Use `--url=https://yoursite.test` for custom URL
- Use `--dry-run` to test without requests

**"No posts found"**
- Create WordPress posts/pages first
- stress-test-simulator auto-creates sample content

**High failure rate / "Invalid signature"**
- Signature bypass should be automatic; check if mu-plugins directory is writable
- Verify WP Statistics settings are configured

**"Bypass ad blockers option not enabled"**
- Enable in WP Statistics settings, or run:
  ```bash
  wp eval "
  \$options = get_option('wp_statistics');
  \$options['bypass_ad_blockers'] = true;
  update_option('wp_statistics', \$options);
  "
  ```

---

## File Structure

```
bin/
├── dummy-tracker-simulator.php   # HTTP-based realistic traffic
├── direct-data-generator.php     # Direct DB insert (fast)
├── stress-test-simulator.php     # Advanced stress testing
├── clear-dummy-data.php          # Database cleanup
├── SIMULATOR.md                  # This documentation
├── data/                         # JSON data files
│   ├── countries.json
│   ├── devices.json
│   ├── referrers.json
│   ├── invalid-data.json
│   └── attack-payloads.json
└── simulator/                    # Classes (stress-test only)
    ├── SimulatorRunner.php
    ├── Generators/
    └── Http/
```

---

**Compatibility**: WP Statistics v15+
