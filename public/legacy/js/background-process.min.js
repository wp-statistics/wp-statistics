jQuery(document).ready(function ($) {const t={migrationNotice:null,init:function(){this.migrationNotice=jQuery("#wp-statistics-background-process-notice"),this.bindEvents(),"progress"===Wp_Statistics_Background_Process_Data.status&&this.startMigration()},bindEvents:function(){this.migrationNotice.length&&this.migrationNotice.find("#start-migration-btn").on("click",this.handleStartMigration)},handleStartMigration:function(t){t.preventDefault(),window.location.href=jQuery(this).attr("href")},startMigration:function(i=0){jQuery.ajax({url:Wp_Statistics_Background_Process_Data.ajax_url,method:"POST",data:{action:"wp_statistics_background_process",wps_nonce:Wp_Statistics_Background_Process_Data.rest_api_nonce,total:i},success:function(n){n.success&&(n.data.completed?t.markAsCompleted():(t.updateProgress(n.data.percentage),i=parseInt(n.data?.total,10)||0,t.startMigration(i)))},error:function(t,i,n){console.error("AJAX request error:",i,n)}})},updateProgress:function(t){this.migrationNotice.length&&this.migrationNotice.find(".remain-percentage").text(t)},markAsCompleted:function(){this.migrationNotice.length&&(this.migrationNotice.closest(".notice").removeClass("notice-info").addClass("notice-success"),this.migrationNotice.html("\n                <p><strong>WP Statistics: Migration Complete</strong></p>\n                <p>All records have been successfully migrated. WP Statistics is now up-to-date.</p>\n            "))}};jQuery(document).ready(function(){t.init()});});