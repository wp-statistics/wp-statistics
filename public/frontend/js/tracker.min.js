window.WpStatisticsUserTracker||(window.WpStatisticsUserTracker={userOnlineIntervalId:null,lastUrl:window.location.href,originalPushState:history.pushState,originalReplaceState:history.replaceState,checkTime:WP_Statistics_Tracker_Object.jsCheckTime,isDndActive:parseInt(navigator.msDoNotTrack||window.doNotTrack||navigator.doNotTrack,10),hasTrackerInitializedOnce:!1,hitRequestSuccessful:!0,init:function(){this.hasTrackerInitializedOnce||(this.hasTrackerInitializedOnce=!0,WP_Statistics_Tracker_Object.option.isPreview||("undefined"==typeof WP_Statistics_Tracker_Object?console.error("WP Statistics: Variable WP_Statistics_Tracker_Object not found. Ensure /wp-content/plugins/wp-statistics/public/frontend/js/tracker.js is either excluded from cache settings or not dequeued by any plugin. Clear your cache if necessary."):(this.checkHitRequestConditions(),WP_Statistics_Tracker_Object.option.userOnline&&this.keepUserOnline()),this.trackUrlChange()))},base64Encode:function(t){const e=(new TextEncoder).encode(t);return btoa(String.fromCharCode.apply(null,e))},getPathAndQueryString:function(){const t=window.location.pathname+window.location.search;return this.base64Encode(t)},getReferred:function(){return this.base64Encode(document.referrer)},checkHitRequestConditions:function(){WP_Statistics_Tracker_Object.option.dntEnabled?1!==this.isDndActive?this.sendHitRequest():console.log("WP Statistics: Do Not Track (DNT) is enabled. Hit request not sent."):this.sendHitRequest()},sendHitRequest:async function(){try{let t=this.getRequestUrl("hit");const e={timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:navigator.language||navigator.userLanguage,screenWidth:window.screen.width,screenHeight:window.screen.height},n=navigator.language.split("-")[0];e.languageFullName=new Intl.DisplayNames(["en"],{type:"language"}).of(n);const i=new URLSearchParams({...WP_Statistics_Tracker_Object.hitParams,resourceUriId:WP_Statistics_Tracker_Object?.resourceUriId,referred:this.getReferred(),page_uri:this.getPathAndQueryString(),timezone:e.timezone,language:e.language,languageFullName:e.languageFullName,screenWidth:e.screenWidth,screenHeight:e.screenHeight}).toString(),s=new XMLHttpRequest;s.open("POST",t,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(i),s.onreadystatechange=function(){4===s.readyState&&(200===s.status?this.hitRequestSuccessful=!1!==JSON.parse(s.responseText).status:(this.hitRequestSuccessful=!1,console.warn("WP Statistics: Hit request failed with status "+s.status)))}.bind(this)}catch(t){this.hitRequestSuccessful=!1,console.error("WP Statistics: Error sending hit request:",t)}},sendOnlineUserRequest:async function(){if(this.hitRequestSuccessful)try{let t=this.getRequestUrl("online");const e=new URLSearchParams({...WP_Statistics_Tracker_Object.onlineParams,referred:this.getReferred(),page_uri:this.getPathAndQueryString()}).toString(),n=new XMLHttpRequest;n.open("POST",t,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(e)}catch(t){console.error("WP Statistics: Error sending online user request:",t)}},keepUserOnline:function(){let t;WP_Statistics_Tracker_Object.option.userOnline&&(null!==this.userOnlineIntervalId&&(clearInterval(this.userOnlineIntervalId),this.userOnlineIntervalId=null),this.userOnlineIntervalId=setInterval(function(){(!WP_Statistics_Tracker_Object.option.dntEnabled||WP_Statistics_Tracker_Object.option.dntEnabled&&1!==this.isDndActive)&&this.hitRequestSuccessful&&this.sendOnlineUserRequest()}.bind(this),this.checkTime),["click","keypress","scroll","DOMContentLoaded"].forEach(e=>{window.addEventListener(e,()=>{clearTimeout(t),t=setTimeout(()=>{null!==this.userOnlineIntervalId&&(clearInterval(this.userOnlineIntervalId),this.userOnlineIntervalId=null)},18e5)})}))},getRequestUrl:function(t){let e=`${WP_Statistics_Tracker_Object.requestUrl}/`;return WP_Statistics_Tracker_Object.option.bypassAdBlockers?e=WP_Statistics_Tracker_Object.ajaxUrl:"hit"===t?e+=WP_Statistics_Tracker_Object.hitParams.endpoint:"online"===t&&(e+=WP_Statistics_Tracker_Object.onlineParams.endpoint),e},updateTrackerObject:function(){const t=document.getElementById("wp-statistics-tracker-js-extra");if(t)try{const e=t.innerHTML.match(/var\s+WP_Statistics_Tracker_Object\s*=\s*(\{[\s\S]*?\});/);e&&e[1]&&(WP_Statistics_Tracker_Object=JSON.parse(e[1]))}catch(e){console.error("WP Statistics: Error parsing WP_Statistics_Tracker_Object",e)}},trackUrlChange:function(){const t=this;window.removeEventListener("popstate",t.handleUrlChange),history.pushState=function(){t.originalPushState.apply(history,arguments),t.handleUrlChange()},history.replaceState=function(){t.originalReplaceState.apply(history,arguments),t.handleUrlChange()},window.addEventListener("popstate",function(){t.handleUrlChange()})},handleUrlChange:function(){window.location.href!==this.lastUrl&&(this.lastUrl=window.location.href,this.updateTrackerObject(),this.hasTrackerInitializedOnce=!1,this.init())}}),window.WpStatisticsEventTracker||(window.WpStatisticsEventTracker={hasEventsInitializedOnce:!1,downloadTracker:!1,linkTracker:!1,init:async function(){this.hasEventsInitializedOnce||WP_Statistics_Tracker_Object.isLegacyEventLoaded||(this.hasEventsInitializedOnce=!0,"undefined"!=typeof WP_Statistics_DataPlus_Event_Object&&(this.downloadTracker=WP_Statistics_DataPlus_Event_Object.options.downloadTracker,this.linkTracker=WP_Statistics_DataPlus_Event_Object.options.linkTracker,(this.downloadTracker||this.linkTracker)&&this.captureEvent()),window.wp_statistics_event=this.handleCustomEvent.bind(this),"undefined"!=typeof WP_Statistics_Marketing_Event_Object&&this.captureCustomClickEvents())},handleCustomEvent:function(t,e={}){const n=WP_Statistics_Tracker_Object.customEventAjaxUrl;e.timestamp=Date.now(),e.resource_id||(e.resource_id=WP_Statistics_Tracker_Object.hitParams.source_id);const i={event_name:t,event_data:JSON.stringify(e)};this.sendEventData(i,n)},captureCustomClickEvents:function(){WP_Statistics_Marketing_Event_Object.events.clicks.forEach(t=>{t.selector&&(null!=t.scope&&t.scope!=WP_Statistics_Tracker_Object.hitParams.source_id||document.querySelectorAll(`${t.selector}`).forEach(e=>{e.addEventListener("click",e=>{const n={text:e.target.textContent,id:e.currentTarget.id,class:e.currentTarget.className,target:e.currentTarget.href};this.handleCustomEvent(t.name,n)})}))})},captureEvent:function(){document.querySelectorAll("a").forEach(t=>{t.addEventListener("click",async t=>await this.handleEvent(t)),t.addEventListener("mouseup",async t=>await this.handleEvent(t))})},handleEvent:async function(t){if("mouseup"==t.type&&1!=t.button)return;const e=this.prepareEventData(t);if(e){const t=WP_Statistics_DataPlus_Event_Object.eventAjaxUrl;await this.sendEventData(e,t)}},prepareEventData:function(t){let e={en:t.type,et:Date.now(),eid:t.currentTarget.id,ec:t.currentTarget.className,ev:"",mb:t.button,fn:"",fx:"",m:"",tu:"",pid:""};return"A"===t.currentTarget.tagName&&(e=this.extractLinkData(t,e)),"undefined"!=typeof WP_Statistics_Tracker_Object&&(e.pid=WP_Statistics_Tracker_Object.hitParams.source_id),e},extractLinkData(t,e){const n=t.target.textContent,i=t.currentTarget.href,s=WP_Statistics_DataPlus_Event_Object.fileExtensions,a=new RegExp("\\.("+s.join("|")+")$","i");n&&(e.ev=n),i&&(e.tu=i);const r=t.currentTarget.classList.contains("woocommerce-MyAccount-downloads-file")||i.includes("download_file=");if(e.wcdl=r,a.test(i)||r){const t=new URL(i).pathname;e.df=r?i.substring(i.lastIndexOf("download_file=")+14).split("&").shift():"",e.dk=r?i.substring(i.lastIndexOf("key=")+4).split("&").shift():"",e.en="file_download",e.fn=r?e.df:t.substring(t.lastIndexOf("/")+1).split(".").shift(),e.fx=r?e.df:t.split(".").pop()}if("click"===e.en){if(!this.linkTracker)return!1;if(i.toLowerCase().includes(window.location.host))return!1}return!("file_download"===e.en&&!this.downloadTracker)&&e},sendEventData:async function(t,e){const n=new URLSearchParams;for(const s in t)n.append(s,t[s]);if(!e)throw new Error("AJAX URL is not defined.");try{(await fetch(e,{method:"POST",keepalive:!0,body:n})).ok}catch(i){console.error("Error:",i)}}}),document.addEventListener("DOMContentLoaded",function(){const t=WP_Statistics_Tracker_Object.option.consentIntegration.name;t||(WpStatisticsUserTracker.init(),WpStatisticsEventTracker.init()),"wp_consent_api"===t&&function(){const t=WP_Statistics_Tracker_Object.option.consentIntegration.status.consent_level,e=WP_Statistics_Tracker_Object.option.consentIntegration.status.track_anonymously;(e||"disabled"==t||wp_has_consent(t))&&(WpStatisticsUserTracker.init(),WpStatisticsEventTracker.init());document.addEventListener("wp_listen_for_consent_change",function(n){const i=n.detail;for(let s in i)i.hasOwnProperty(s)&&s===t&&"allow"===i[s]&&(WpStatisticsUserTracker.init(),WpStatisticsEventTracker.init(),e&&WpStatisticsUserTracker.checkHitRequestConditions())})}(),"real_cookie_banner"===t&&(window.consentApi?.consent("wp-statistics")||Promise.resolve()).then(()=>{WpStatisticsUserTracker.init(),WpStatisticsEventTracker.init()}).catch(()=>{const t=window.consentApi?.consentSync("wp-statistics-with-data-processing");null!=t.cookie&&t.cookieOptIn?(WpStatisticsUserTracker.init(),WpStatisticsEventTracker.init()):console.log("WP Statistics: Real Cookie Banner consent is not given to track visitor information.")})});